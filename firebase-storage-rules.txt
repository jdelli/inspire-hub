# Firebase Storage Security Rules for Contract Templates
# Copy these rules to your Firebase Console > Storage > Rules

rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Contract templates storage rules
    match /contract-templates/{templateType}/{fileName} {
      // Allow read access to authenticated users
      allow read: if request.auth != null;
      
      // Allow write access only to admin users
      // You can customize this based on your authentication system
      allow write: if request.auth != null 
        && request.auth.token.admin == true;
      
      // Allow upload of specific file types
      allow create: if request.auth != null 
        && request.auth.token.admin == true
        && resource.contentType.matches('application/pdf|application/msword|application/vnd.openxmlformats-officedocument.wordprocessingml.document|text/plain|text/html')
        && resource.size < 10 * 1024 * 1024; // 10MB limit
    }
    
    // Default rule - deny all other access
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}

# Alternative simpler rules (less secure but easier to test):
# 
# rules_version = '2';
# service firebase.storage {
#   match /b/{bucket}/o {
#     match /{allPaths=**} {
#       allow read, write: if request.auth != null;
#     }
#   }
# }
